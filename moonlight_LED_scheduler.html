
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. MoonShineR: Moonlight scheduler &#8212; MoonShine Instruction Manual</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. MoonShineR: Sunlight/twilight scheduler" href="sunlight_twilight_LED_scheduler.html" />
    <link rel="prev" title="1. MoonShineR: R package" href="lux_calculator.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MoonShine Instruction Manual</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="overview.html">
                    Overview
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lux_calculator.html">
   1.
   <span style="font-variant:small-caps;">
    MoonShineR
   </span>
   : R package
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2.
   <span style="font-variant:small-caps;">
    MoonShineR
   </span>
   : Moonlight scheduler
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sunlight_twilight_LED_scheduler.html">
   3.
   <span style="font-variant:small-caps;">
    MoonShineR
   </span>
   : Sunlight/twilight scheduler
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="edit_LED_schedule_csv.html">
   4. Edit LED schedule
   <code class="docutils literal notranslate">
    <span class="pre">
     .csv
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moonshine_hardware_setup.html">
   5.
   <span style="font-variant:small-caps;">
    MoonShineP
   </span>
   : Hardware setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moonshine_software_setup.html">
   6.
   <span style="font-variant:small-caps;">
    MoonShineP
   </span>
   : Software setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moonshine_calibration.html">
   7.
   <span style="font-variant:small-caps;">
    MoonShineP
   </span>
   : Calibration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="moonshine_launch_procedure.html">
   8.
   <span style="font-variant:small-caps;">
    MoonShineP
   </span>
   : Launch procedure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="download.html">
   Download files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code.html">
   Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/Crampton-Lab/MoonShine/master?urlpath=tree/docs/moonlight_LED_scheduler.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Crampton-Lab/MoonShine"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Crampton-Lab/MoonShine/issues/new?title=Issue%20on%20page%20%2Fmoonlight_LED_scheduler.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/moonlight_LED_scheduler.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/moonlight_LED_scheduler.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#key-features">
   Key features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages-required">
   Packages required
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow">
   Workflow
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rgbw-spectral-control">
     RGBW spectral control
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#horizon-obstruction">
     Horizon obstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cloud-cover-simulation">
     Cloud cover simulation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cloud-period">
       Cloud period
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cloud-change-frequency">
       Cloud change frequency
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transmission-mean">
       Transmission mean
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transmission-standard-deviation-sd">
       Transmission standard deviation (SD)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>2. <span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#key-features">
   Key features
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages-required">
   Packages required
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow">
   Workflow
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rgbw-spectral-control">
     RGBW spectral control
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#horizon-obstruction">
     Horizon obstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cloud-cover-simulation">
     Cloud cover simulation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cloud-period">
       Cloud period
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cloud-change-frequency">
       Cloud change frequency
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transmission-mean">
       Transmission mean
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transmission-standard-deviation-sd">
       Transmission standard deviation (SD)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="span-style-font-variant-small-caps-moonshiner-span-moonlight-scheduler">
<span id="content-moonshiner-moon"></span><h1>2. <span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler<a class="headerlink" href="#span-style-font-variant-small-caps-moonshiner-span-moonlight-scheduler" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p><em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em> is a R script designed to be used in conjunction with <em><span style="font-variant:small-caps;">MoonShineP</span></em> to re-create moonlight cycles in the lab.</p></li>
<li><p><em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em> runs the same set of calculations as <em><span style="font-variant:small-caps;">MoonShineR</span>: R package</em> to predict moonlight illuminance. However, unlike the R package, the output table  <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code> contains lists of LED intensity values over time. The interval between successive LED intensity values is constrained to one minute (i.e., the LED intensities are refreshed every minute).</p></li>
<li><p>Download <em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em> in <a class="reference internal" href="download.html#content-lightbox-download"><span class="std std-ref">Download files</span></a>.</p></li>
</ul>
<section id="key-features">
<h2>Key features<a class="headerlink" href="#key-features" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Re-create a realistic moonlight cycle in a laboratory or other indoor environment.</p></li>
<li><p>Allows users to specify a geographical location and time period so that the re-created moonlight reflects real nightly, monthly, and seasonal changes.</p></li>
<li><p>Provides option to simulate the obstruction of moonlight by surrounding objects (e.g., mountains, trees)</p></li>
<li><p>Provides option to simulate light attenuation caused by clouds, with the ability to fine tune the cloud behavior in a stochastic model.</p></li>
<li><p>Provides option to adjust the LED light spectrum by controlling the relative intensity of each RGBW channel. This can be useful in approximating the color shift of certain habitats (e.g., the blue shift in deep clear ocean or lake water, or the red shift of sodium vapor street lighting).</p></li>
</ul>
</section>
<section id="packages-required">
<h2>Packages required<a class="headerlink" href="#packages-required" title="Permalink to this headline">#</a></h2>
<ul>
<li><p>library(suncalc) Calculates astronomical variables given a time and location, including moon phase, moon altitude, sun altitude, and the moon to Earth distance.</p></li>
<li><p>library(dplyr) Facilitates data wrangling.</p></li>
<li><p>library(rpmodel) Calculates atmospheric pressure at a given site elevation.</p></li>
<li><p>library(lubridate) Makes datetime format easier to work with.</p></li>
<li><p>library(REdaS) Converts between degree angle and radian.</p></li>
<li><p>library(npreg) Fits smoothing splines.</p></li>
<li><p>library(ggplot2) Create plots.</p></li>
<li><p>library(beepr) Makes a notification sound.</p></li>
<li><p>library(progress) Display a progress bar of the computation progress.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This website <a class="reference external" href="https://r-coder.com/r-tutorials/r-basics/">R Coder</a> is a good resource for learning basic R functions. Start here if you are completely new to R and need instructions on how to load R, set the working directory, install packages and run code.</p>
</div>
</li>
</ul>
</section>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">#</a></h2>
<p>Below is a summary of the main steps required to run <em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em>. The code itself is also commented. The “(!)” symbol denotes a line where the user must enter information.</p>
<ol>
<li><p>Set the working directory. This is where the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> (schedule file) and .png (illuminance ~ time) plot are saved.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setwd</span><span class="p">(</span><span class="s2">&quot;/Users/lokpoon/Desktop&quot;</span><span class="p">)</span> <span class="c1"># (!) </span>
</pre></div>
</div>
</li>
<li><p>Set the geographical location for the simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">latitude</span> <span class="o">&lt;-</span> <span class="o">-</span><span class="mf">4.21528</span> <span class="c1"># (!) Latitude in decimal degrees (e.g., -4.21528)</span>
<span class="n">longitude</span> <span class="o">&lt;-</span> <span class="o">-</span><span class="mf">69.94056</span> <span class="c1"># (!) Longitude in decimal degrees (e.g., -69.94056)</span>
</pre></div>
</div>
</li>
<li><p>Set the site elevation in m above mean sea level.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">site_elev</span> <span class="o">&lt;-</span> <span class="mi">0</span> <span class="c1"># (!) site elevation in meters (e.g., 0 = sea level)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This website <a class="reference external" href="https://www.dcode.fr/earth-elevation">dcode.fr</a> can be used to determine elevation for a specific geographical coordinate, by accessing NASA Shuttle Radar Topography Mission databases.</p>
</div>
</li>
<li><p>Set the time zone.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_zone</span> <span class="o">&lt;-</span> <span class="s2">&quot;EST&quot;</span> <span class="c1"># (!)</span>
<span class="c1"># For a list of time zone names, enter OlsonNames(tzdir = NULL) in R console</span>
</pre></div>
</div>
</li>
<li><p>Set the starting date, starting time, and simulation duration in days.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_start</span> <span class="o">&lt;-</span> <span class="s2">&quot;2022-07-26&quot;</span> <span class="c1"># (!) Starting date of the simulation (YYYY-MM-DD)</span>
<span class="n">time_start</span> <span class="o">&lt;-</span> <span class="s2">&quot;18:00:00&quot;</span> <span class="c1"># (!) Starting time of the simulation (hh:mm:ss)</span>
<span class="n">duration_day</span> <span class="o">&lt;-</span> <span class="mf">29.5</span> <span class="c1"># (!) Duration of simulation in days</span>
</pre></div>
</div>
</li>
<li><p>Set the simulation time interval to 1 (i.e., the temporal resolution). The time_interval_minutes is constrained to 1 and cannot be changed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_interval_minutes</span> <span class="o">&lt;-</span> <span class="mi">1</span> <span class="c1"># (!) The temporal resolution in minutes</span>
</pre></div>
</div>
</li>
<li><p>Decide whether to change the default darksky_value, a constant value that is added to moonlight illuminance for representing starlight and airglow (Hänel et al. 2018); Hänel et al. (2018) report starlight and airglow to vary between 0.0006 and 0.0009. Leaving it at the default of 0.0008 lx means that even when the moon is below the horizon, the LED array will still light up to re-create 0.0008 lx (<a class="reference internal" href="#starlight"><span class="std std-numref">Fig. 5</span></a>). Otherwise, the darksky_value should be set at zero if the user wishes the room to be completely dark when the moon is below the horizon.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">darksky_value</span> <span class="o">&lt;-</span> <span class="mf">0.0008</span> <span class="c1"># (!) Choose from between 0.0006 to 0.0009. Default = 0.0008</span>
</pre></div>
</div>
<figure class="align-default" id="starlight">
<img alt="_images/starlight.png" src="_images/starlight.png" />
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Photograph of a SK6812 RGBW LED strip at low illuminance. When the LED arrays re-create illuminance near the lower limit, for example at the 0.0008 lx of combined starlight and airglow, the arrays appear to have “color banding”. This is because at this illuminance, the LED is still applying the RGBW channel fractions (step 5). This is normal. After the light has been diffused by the lightbox, it will result in ambient lighting with uniform color.</span><a class="headerlink" href="#starlight" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Set the calibration illuminance point. See <a class="reference internal" href="moonshine_calibration.html#content-lightbox-calibration"><span class="std std-ref">7. MoonShineP: Calibration</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_max</span> <span class="o">&lt;-</span> <span class="mf">0.4</span> <span class="c1"># (!) Define an intensity upper limit (in lux)</span>
</pre></div>
</div>
</li>
<li><p>Specify the number of LEDs per SK6812 LED strip and the number of daisy-chained strips.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">diode_per_strip</span> <span class="o">&lt;-</span> <span class="mi">144</span> <span class="c1"># (!) Number of LEDs per strip</span>
 <span class="n">strip_count</span> <span class="o">&lt;-</span> <span class="mi">2</span> <span class="c1"># (!) Number of daisy-chained LED strips</span>
</pre></div>
</div>
</li>
<li><p>Determine the LED color spectrum by specifying the intensity output (0-1) of each RGBW channel, a feature termed “spectral control”. To approximate a natural moonlight spectrum, leave this setting at the default values shown below (<a class="reference internal" href="#moon-spectrum"><span class="std std-numref">Fig. 6</span></a>). Note that these default values are intended for the warm white SK6812 LED strips made by BTF lightning. (see <a class="reference internal" href="moonshine_hardware_setup.html#content-hardware-materials"><span class="std std-ref">Materials</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">white_fraction</span> <span class="o">&lt;-</span> <span class="mf">1.0</span> <span class="c1"># (!) White. Default = 1.0</span>
 <span class="n">red_fraction</span> <span class="o">&lt;-</span> <span class="mf">0.08</span> <span class="c1"># (!) Red. Default = 0.08</span>
 <span class="n">green_fraction</span> <span class="o">&lt;-</span> <span class="mf">0.36</span> <span class="c1"># (!) Green. Default = 0.36</span>
 <span class="n">blue_fraction</span> <span class="o">&lt;-</span> <span class="mf">0.19</span> <span class="c1"># (!) Blue. Default = 0.19</span>
</pre></div>
</div>
<figure class="align-default" id="moon-spectrum">
<a class="reference internal image-reference" href="_images/moon_spectrum.jpg"><img alt="_images/moon_spectrum.jpg" src="_images/moon_spectrum.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">A comparison of the moonlight and LED lightbox spectral irradiance. RGBW intensity fraction are set here to the default values. R = 0.08, G = 0.36, B = 0.19, W = 1.0.</span><a class="headerlink" href="#moon-spectrum" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Go to <a class="reference internal" href="#content-rgbw"><span class="std std-ref">RGBW spectral control</span></a> for details on how to adjust the RGBW intensity output for approximating the spectral-shift characteristics of certain habitats.</p>
</li>
<li><p>Specify whether to re-create the effect of surround tall objects blocking moonlight. We refer to this phenomenon as the “horizon obstruction”, for example when distant tree canopy or mountain range obscure a rising/setting moon near the horizon. Recreating this phenomenon might re-create a more realistic light scenario for the captive animal. See <a class="reference internal" href="#content-horizon"><span class="std std-ref">Horizon obstruction</span></a> for more details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">horizon_option</span> <span class="o">&lt;-</span> <span class="n">FALSE</span> <span class="c1"># (!) TRUE to enable</span>
</pre></div>
</div>
</li>
<li><p>Specify whether to re-create the light attenuation by a changing cloud cover regime. See <a class="reference internal" href="#content-cloud"><span class="std std-ref">Cloud cover simulation</span></a> for more details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cloud_option</span> <span class="o">&lt;-</span> <span class="n">FALSE</span> <span class="c1"># (!) TRUE to enable cloud simulator</span>
</pre></div>
</div>
</li>
<li><p>Run the code in the section “START OF ILLUMINATION COMPUTATION” through to “END OF ILLUMINATION COMPUTATION”.</p></li>
<li><p>Generate a moon schedule file <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code> by running the codes in the section of “GENERATE LED_schedule_moon.csv” (<a class="reference internal" href="#moon-table"><span class="std std-numref">Fig. 7</span></a>). And plot (See Steps 10-12 in <a class="reference internal" href="lux_calculator.html#content-luxcalculator"><span class="std std-ref">1. MoonShineR: R package</span></a>)</p>
<figure class="align-default" id="moon-table">
<img alt="_images/moon_table.jpg" src="_images/moon_table.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Dataframe of <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code> file in R. The columns with green-highlighted headers are the RGBW intensity values that <span style="font-variant:small-caps;">MoonShineP</span> read to generate illuminance. The columns with yellow-highlighted headers are also generated by <span style="font-variant:small-caps;">MoonShineR</span> - R package. This tabulated information is exported to the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file, which is read by <span style="font-variant:small-caps;">MoonShineP</span>. Right click and select ‘Open image in new tab’ to enlarge figure.</span><a class="headerlink" href="#moon-table" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>Save a <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code>, containing the LED intensity values over time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">moon_value_table</span><span class="p">,</span><span class="s2">&quot;lux_calculator_output.csv&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Display a plot of the illuminance prediction over time, as specified in step 8, by running the code that starts with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_output</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">()</span> <span class="o">+</span> <span class="n">theme_rectangular_clean</span> <span class="o">+</span> <span class="o">......</span>
</pre></div>
</div>
<p>And ends with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_output</span>
</pre></div>
</div>
</li>
<li><p>Save this plot to working directory (<code class="xref std std-numref docutils literal notranslate"><span class="pre">one_month</span></code>), by running the following line of code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggsave</span><span class="p">(</span><span class="s2">&quot;plot_output.png&quot;</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">4488</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;px&quot;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">450</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Finally, the section of code depicted below checks if you have any lunar eclipse events within your simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if (any(abs(moon_value_table$phase_angle) &lt; 1.5 &amp; moon_value_table$sun_altitude &lt; 0)) { # eclipse defined as a moon with phase angle &lt; 1.5 during nighttime
  print(&quot;ECLIPSE IN SIMULATION!!!&quot;)
  eclipse_list &lt;- (abs(moon_value_table$phase_angle) &lt; 1.5 &amp; moon_value_table$sun_altitude &lt; 0)
  moon_value_table[which(eclipse_list == TRUE),]
} else {
  print(&quot;no eclipse in simulation&quot;)
}
</pre></div>
</div>
</li>
</ol>
<ul>
<li><p>If there is no eclipse, a “no eclipse in simulation” message will appear in the R console after the simulation is complete.</p></li>
<li><p>If there is an eclipse, “ECLIPSE IN SIMULATION!!!” will appear in the console. <em><span style="font-variant:small-caps;">MoonShineR</span></em> will also report a list of all time intervals affected by both the penumbral and umbral stages of the eclipse (<a class="reference internal" href="lux_calculator.html#eclipse"><span class="std std-numref">Fig. 3</span></a>). Note that <em><span style="font-variant:small-caps;">MoonShineR</span></em> does not simulate the transient reduction in illuminated fraction or moonlight illuminance during a lunar eclipse (these variables will therefore be incorrectly reported reported by <em><span style="font-variant:small-caps;">MoonShineR</span></em> during the event).</p>
<figure class="align-default" id="eclipse">
<img alt="_images/eclipse.jpg" src="_images/eclipse.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Running a <em><span style="font-variant:small-caps;">MoonShineR</span></em> simulation during an eclipse will return a warning message and a list of the minutes of the eclipse event.</span><a class="headerlink" href="#eclipse" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
</ul>
<section id="rgbw-spectral-control">
<span id="content-rgbw"></span><h3>RGBW spectral control<a class="headerlink" href="#rgbw-spectral-control" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em> does not re-create spectral changes associated with variation in the moon altitude; these are negligible. In other words, moonlight is re-created with a constant spectrum, regardless of moon altitude.</p></li>
<li><p>Certain habitats are characterized by unique wavelength-dependent attenuation, which researchers may consider emulating. <em><span style="font-variant:small-caps;">MoonShineR</span> Moonlight scheduler</em> provides the option to adjust the relative intensity of the RGBW channels (<a class="reference internal" href="#habitat"><span class="std std-numref">Fig. 10</span></a>).</p></li>
<li><p>Adjusting the RGBW spectrum requires the user to have a profound understanding of the spectral characteristics of their habitat target, and the visual sensitivity of the subject animal(s). This is, in part, because the RGBW channels have a very specific and limited peak and spectral range when compared to the complex spectral properties of natural habitats. Consequently, some habitat light spectrum approximations would be more realistic (e.g., when the habitat”s spectral peak corresponds to one of the RGBW peaks), while other approximations might be unsatisfactory.</p></li>
<li><p>Knowing the animal’s spectral sensitivity can help to assess the validity of a re-created LED spectrum. For example mammals do not see UV light, so the lack of UV in warm white SK6812 LED strips does not constitute a limitation. However, this might not be the case for animals with UV sensitive vision (including many invertebrates and some vertebrates).</p></li>
<li><p>If the user has a spectrometer, they should specify the RGBW intensity fraction in <em><span style="font-variant:small-caps;">MoonShineR</span>: Moonlight scheduler</em> and measure the resulting overall LED spectral irradiance.</p></li>
<li><p>If the user does not have a spectrometer, they should use the provided Microsoft Excel spreadsheet <code class="docutils literal notranslate"><span class="pre">RGBW_LED_spectrum.xlsx</span></code> (download in <a class="reference internal" href="download.html#content-lightbox-download"><span class="std std-ref">Download files</span></a>) to predict the resulting overall LED spectral irradiance (<a class="reference internal" href="#excel-predict"><span class="std std-numref">Fig. 9</span></a>).</p></li>
</ul>
<figure class="align-default" id="excel-predict">
<img alt="_images/excel_predict.jpg" src="_images/excel_predict.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Using the provided Excel spreadsheet <code class="docutils literal notranslate"><span class="pre">RGBW_LED_spectrum.xlsx</span></code> to visualize how the overall LED light spectrum will be based on the specified intensity fraction. The user can modify the RGBW intensiy fractions shown in the upper panel (here shown with default values), and the lower two plots will reflect the changes. The middle plot is the predicted overall spectral irradiance of the LED light. The bottom plot shows the contribution of the individual RGBW channels, which were summed together to produce the middle plot.</span><a class="headerlink" href="#excel-predict" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="habitat">
<img alt="_images/habitat.jpg" src="_images/habitat.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">A comparison of the spectra of the unadjusted RGBW channels of the SK68212 LED array to the peak spectral wavelengths of four strongly color-shifted habitats. This plot compares the spectra of the LED RGBW channels to a few habitats with strong spectral shifts. Here, the RGBW channels are all set to the maximum intensity in MoonShineR (i.e., R = 1.0, G = 1.0, B = 1.0, W = 1.0). Note that at the same intensity level, the RGBW channels each have a peak at a different absolute irradiance level (e.g., blue is stronger than green). The dotted line indicates the spectral peaks of four distinctive habitats (clear ocean [Jerlov, 1976], forest understory [Veilleux &amp; Cummings et al, 2012],high-transparency clearwater Amazon rivers, tannin-stained blackwater Amazon rivers, and turbid, tannin-stained whitewater Amazon river [Costa et al., 2013]). The spectral peak of the clear ocean and blue channel are close, while the far red peak of the tannin-stained river cannot be re-created accurately by the red or white channels. These peaks are, of course, an oversimplified representation of the habitats’ spectra; the user should always refer to the complete spectral irradiance plot for a given habitat. Ideally, the user should make their own spectral irradiance measurements at their study site since the spectral properties of the same habitat type (e.g. clearwater river) can still vary greatly (Johnsen, 2012).</span><a class="headerlink" href="#habitat" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="horizon-obstruction">
<span id="content-horizon"></span><h3>Horizon obstruction<a class="headerlink" href="#horizon-obstruction" title="Permalink to this headline">#</a></h3>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Horizon obstruction automatically applies to all nights, since it is a topographical feature that is constantly present at the location. The obstruction is also assumed, for the sake of simplicity, to be present in all directions, and therefore will affect both the moonrise and moonset.</p>
</div>
<ul>
<li><p>There are three settings that modify the behavior of horizon obstruction (<a class="reference internal" href="#horizon"><span class="std std-numref">Fig. 11</span></a>):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(*) The angular altitude refers to the angle above the horizon, from 0 degrees at the horizon to 90 degrees at the zenith.)</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">horizon_transition_end</span> <span class="o">&lt;-</span> <span class="mi">57</span> <span class="c1"># (!) angular altitude* ABOVE which there is a zone of unobstructed illumination.</span>
<span class="c1"># We define this as Zone A.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">horizon_elev</span> <span class="o">&lt;-</span> <span class="mi">55</span> <span class="c1"># (!) angular altitude* BELOW which there is maximum light attenuation (e.g. due to a mountain or tree line).</span>
<span class="c1"># We DEFINE THIS AS Zone C.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">horiz_transmission</span> <span class="o">&lt;-</span> <span class="mf">0.15</span> <span class="c1"># (!) the proportional transmission of light in Zone A relative to Zone C.</span>
</pre></div>
</div>
<figure class="align-default" id="horizon">
<img alt="_images/horizon.jpg" src="_images/horizon.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">An example of the horizon obstruction effect on illuminance, with the horizon_option enabled, and with the above three settings. Illuminance when the moon is below 55 degrees (zone C) will be 15% of the light level above 57 degrees (zone A, where the moon rises above the obstruction). In the transition zone (zone B) between 55 and 57 degrees, a linear transition of illuminance is applied. This makes light level transitions less abrupt when the simulated moon rises above simulated obstacles. MoonShineP will read the <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code> and re-create the same illuminance behavior as described in these plots. Dark gray areas denote night, light gray areas denote twilight, white areas denote day.</span><a class="headerlink" href="#horizon" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
</ul>
</section>
<section id="cloud-cover-simulation">
<span id="content-cloud"></span><h3>Cloud cover simulation<a class="headerlink" href="#cloud-cover-simulation" title="Permalink to this headline">#</a></h3>
<p>The cloud simulation works by creating a random list of numbers (representing transmission), which are taken from a normal distribution with a user-defined mean and standard deviation. A spline function is then fitted through these numbers to yield a varying but smoothed modulation of illuminance over time. There are six variables that need to be configured for cloud cover simulation, which are listed below. The values of the six variables have some mutual effects on each other. The only way to visualize how the simulated cloud will modulate a moonlight regime is to visualize the spline function in a plot generated by <em><span style="font-variant:small-caps;">MoonShineR</span></em>’s plotting functions.</p>
<section id="cloud-period">
<h4>Cloud period<a class="headerlink" href="#cloud-period" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>The first three variables define the time periods during which cloud simulation is applied. Period outside of this period will not have clouds.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_start_cloud</span> <span class="o">&lt;-</span> <span class="s2">&quot;2022-07-26&quot;</span> <span class="c1"># (!) starting date of cloud effect (YYYY-MM-DD)</span>
<span class="n">time_start_cloud</span> <span class="o">&lt;-</span> <span class="s2">&quot;18:00:00&quot;</span> <span class="c1"># (!) starting time of cloud effect (hh:mm:ss)</span>
<span class="n">duration_day_cloud</span> <span class="o">&lt;-</span> <span class="mf">29.5</span> <span class="c1"># (!) duration of the cloud effect</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user wants to apply cloud cover to the entire simulation period, the user should use the same date and time values used to start the entire simulation (see Step 5 in <a class="reference internal" href="lux_calculator.html#content-luxcalculator"><span class="std std-ref">1. MoonShineR: R package</span></a> and enter the entire simulation duration as the duration_day_cloud value.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user wants to generate a more complex cloud schedule that is not limited to a single period (e.g., only cloud in the second and eighth day of the simulation),the user can generate multiple <code class="docutils literal notranslate"><span class="pre">LED_schedule_moon.csv</span></code> versions with the respective settings and merge these together in Excel to produce a single <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file. See <a class="reference internal" href="edit_LED_schedule_csv.html#content-edit"><span class="std std-ref">4. Edit LED schedule .csv</span></a>.</p>
</div>
</li>
</ul>
</section>
<section id="cloud-change-frequency">
<h4>Cloud change frequency<a class="headerlink" href="#cloud-change-frequency" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>Specify the frequency of the change in cloud density.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cloud_change_freq</span> <span class="o">&lt;-</span> <span class="mi">5</span> <span class="c1"># (!) Sets how quickly the clouds are transitioning (in minutes). </span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Setting cloud_change_freq smaller than 5 may crash the R session.</p>
</div>
</li>
</ul>
<p><strong>Example of cloud_change_freq = 5</strong></p>
<figure class="align-default" id="freq5smooth">
<a class="reference internal image-reference" href="_images/freq5smooth.jpg"><img alt="_images/freq5smooth.jpg" src="_images/freq5smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">The smoothing spline with cloud_change_freq = 5</span><a class="headerlink" href="#freq5smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="freq5output">
<a class="reference internal image-reference" href="_images/freq5output.jpg"><img alt="_images/freq5output.jpg" src="_images/freq5output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline of <a class="reference internal" href="#freq5smooth"><span class="std std-numref">Fig. 12</span></a> applied. A value of 5 simulates rapid movement of clouds across the moon’s disk, replicating the effect of high-speed winds at cloud altitude.</span><a class="headerlink" href="#freq5output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Example of cloud_change_freq = 30</strong></p>
<figure class="align-default" id="freq30smooth">
<a class="reference internal image-reference" href="_images/freq30smooth.jpg"><img alt="_images/freq30smooth.jpg" src="_images/freq30smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">The smoothing spline with cloud_change_freq = 30</span><a class="headerlink" href="#freq30smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="freq30output">
<a class="reference internal image-reference" href="_images/freq30output.jpg"><img alt="_images/freq30output.jpg" src="_images/freq30output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline of <a class="reference internal" href="#freq30smooth"><span class="std std-numref">Fig. 14</span></a> applied. A value of 60 represents very slow cloud movement.</span><a class="headerlink" href="#freq30output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="transmission-mean">
<h4>Transmission mean<a class="headerlink" href="#transmission-mean" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>Transmission is defined here as the fraction of light that passes through the cloud. The user specifies the mean of the transmission (transmission_mean), with 1 being almost full transmission (little attenuation) and 0 being almost no transmission (near total attenuation).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transmission_mean</span> <span class="o">&lt;-</span> <span class="mi">1</span> <span class="c1"># (!) Set the mean of the normal distribution.</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The user should set transmission_mean between 1 and 2 or between -1 and 0. Setting it to 1 or above will instruct <span style="font-variant:small-caps;">MoonShineR</span> to use the left side of the normal distribution, which will reduce the frequency and extremity of simulated cloud cover (however, we recommend not exceeding 2). Zero or a negative value will use the right side of the normal distribution, thereby simulating denser cloud cover with occasional periods of no cloud cover (however, we recommend values no lower than -1). We recommend not using a value between 0 and 1.</p>
</div>
</li>
</ul>
<p><strong>Example of transmission_mean = 1.2</strong></p>
<figure class="align-default" id="mean12smooth">
<a class="reference internal image-reference" href="_images/mean12smooth.jpg"><img alt="_images/mean12smooth.jpg" src="_images/mean12smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">The smoothing spline with transmission_mean = 1.2</span><a class="headerlink" href="#mean12smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="mean12output">
<a class="reference internal image-reference" href="_images/mean12output.jpg"><img alt="_images/mean12output.jpg" src="_images/mean12output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline of <a class="reference internal" href="#mean12smooth"><span class="std std-numref">Fig. 16</span></a> applied. By increasing the transmission_mean slightly above 1, it decreases the overall “thickness” of the cloud, thereby simulating the occasional passing of thin cloud.</span><a class="headerlink" href="#mean12output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Example of transmission_mean = -0.2</strong></p>
<figure class="align-default" id="mean02smooth">
<a class="reference internal image-reference" href="_images/mean02smooth.jpg"><img alt="_images/mean02smooth.jpg" src="_images/mean02smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">The smoothing spline with transmission_mean = -0.2</span><a class="headerlink" href="#mean02smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="mean02output">
<a class="reference internal image-reference" href="_images/mean02output.jpg"><img alt="_images/mean02output.jpg" src="_images/mean02output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline of <a class="reference internal" href="#mean02smooth"><span class="std std-numref">Fig. 18</span></a> applied. Reducing the transmission_mean slightly below 0 increases the overall “thickness” of the cloud. The behaviour of transmission_mean at around 0 is the complete opposite of 1. Instead of using the “left” side of the normal distribution, it uses the “right” side. Meaning that instead of the occasional passing of cloud, it simulates occasional windows of clear sky in a cloudy scenerio.</span><a class="headerlink" href="#mean02output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="transmission-standard-deviation-sd">
<h4>Transmission standard deviation (SD)<a class="headerlink" href="#transmission-standard-deviation-sd" title="Permalink to this headline">#</a></h4>
<ul>
<li><p>We recommend setting the standard deviation of transmission (transmission_sd) to a starting value of 0.5. All the previous plots in this Cloud Simulation section (<a class="reference internal" href="#freq5smooth"><span class="std std-numref">Fig. 12</span></a> through <a class="reference internal" href="#mean02output"><span class="std std-numref">Fig. 19</span></a>) have transmission_sd = 0.5. Increasing the transmission_sd increases the range of transmission variation, making the cloud effect more unpredictable (i.e., simulating patchy clouds). Reducing the transmission_sd limits the range of transmission variation, allowing for simulation of an evenly overcast sky.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transmission_sd</span> <span class="o">&lt;-</span> <span class="mf">0.5</span> <span class="c1"># (!) Set the standard deviation of transmission.</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>transmission_sd = 1</strong></p>
<figure class="align-default" id="sd1smooth">
<a class="reference internal image-reference" href="_images/sd1smooth.jpg"><img alt="_images/sd1smooth.jpg" src="_images/sd1smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">The smoothing spline with transmission_sd = 1</span><a class="headerlink" href="#sd1smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="sd1output">
<a class="reference internal image-reference" href="_images/sd1output.jpg"><img alt="_images/sd1output.jpg" src="_images/sd1output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline <a class="reference internal" href="#sd1smooth"><span class="std std-numref">Fig. 20</span></a> applied. The illuminance switches drastically from one moment to the next with a higher transmission_sd = 1. This simulates the effect of patchy clouds with many windows of opening.</span><a class="headerlink" href="#sd1output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>transmission_sd = 0.1</strong></p>
<figure class="align-default" id="sd01smooth">
<a class="reference internal image-reference" href="_images/sd01smooth.jpg"><img alt="_images/sd01smooth.jpg" src="_images/sd01smooth.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">The smoothing spline with transmission_sd = 1 (and lower transmission_mean = 0.5 )</span><a class="headerlink" href="#sd01smooth" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="sd01output">
<a class="reference internal image-reference" href="_images/sd01output.jpg"><img alt="_images/sd01output.jpg" src="_images/sd01output.jpg" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">The final moonlight illuminance with the smoothing spline of <a class="reference internal" href="#sd01smooth"><span class="std std-numref">Fig. 22</span></a> applied. This simulates an overcast sky with relatively little variation in illuminance.</span><a class="headerlink" href="#sd01output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Selecting the best-suited cloud settings should be based on the smoothing spline preview.  Users are encouraged to try out different combinations of cloud settings. The user can see a preview of the smoothing spline by running the code from the beginning through “END OF CLOUD EFFECT GENERATOR”. If the paticular smoothing spline looks undesirable, running the section of code again will generate another smoothing spline that looks different because it uses a random number generator.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>By default, the cloud effect is generated randomly every time the script is run. If the user would like to generate the same cloud pattern when rerunning the same set, un-comment the line of  <em>‘# set.seed(1)</em> in the section of “START OF CLOUD EFFECT GENERATOR”. Changing the number within  <em>‘# set.seed(1)</em> will change the paticular set of random number that will be generated for creating the cloud effect.</p>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="lux_calculator.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">1. <span style="font-variant:small-caps;">MoonShineR</span>: R package</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="sunlight_twilight_LED_scheduler.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3. <span style="font-variant:small-caps;">MoonShineR</span>: Sunlight/twilight scheduler</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By C. Lok Poon, Ian T. Jenks & W.G.R., Crampton. University of Central Florida.<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>